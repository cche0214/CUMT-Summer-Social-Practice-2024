<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"> <!-- 指定文档的字符编码 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- 视口设置 -->
    <title>中国矿业大学·E心向党社会实践</title> <!-- 网页标题 -->
    <script src="js\echarts.js"></script> <!-- 引入ECharts库 -->
    <script src="js\chain.js"></script> <!-- 引入自定义的chain.js脚本 -->
    <script src="js\jquery-3.5.1.js"></script> <!-- 引入jQuery库 -->
    <link rel="stylesheet" href="css/bootstrap.min.css"> <!-- 引入Bootstrap CSS库 -->

    <style>
        html, body {
            height: 100%; /* 设置 html 和 body 高度为 100% */
            margin: 0; /* 去除默认的外边距 */
            padding: 0; /* 去除默认的内边距 */
            overflow: hidden; /* 隐藏滚动条 */
        }

        .container {
            height: 100%; /* 设置容器高度为 100% */
            width: 100%; /* 设置容器宽度为 100% */
            display: flex; /* 使用 flexbox 布局 */
            justify-content: center; /* 水平居中对齐 */
            align-items: center; /* 垂直居中对齐 */
        }

        #content-left {
            width: 100%; /* 设置内容块宽度为 100% */
            height: 100%; /* 设置内容块高度为 100% */
        }

        #main {
            width: 100%; /* 设置图表容器宽度为 100% */
            height: 100%; /* 设置图表容器高度为 100% */
        }
    </style>
</head>

<body style="background-color: gray"> <!-- 设置背景颜色 -->
<div class="container" style="height: 100%; width: 100%"> <!-- 容器设置 -->
    <div id="content-left" class="col-md-12" style="margin-top: 20px"> <!-- 设置左侧内容块 -->
        <div id="main" style="width: 100%; height: 800px"></div> <!-- 主图表容器 -->
    </div>
</div>
</body>

<script>
    // echarts初始化：获取myChart对象
    var myChart = echarts.init(document.getElementById('main'));
    
    // 使用jQuery在文档加载完毕后执行
    $(function(){
        // 获取表格对象
        let table = $("#tbody");

        // 发起ajax请求，获取json数据
        $.ajax({
            url: "json/Robotsalse.json", // json文件位置
            type: "GET", // 请求类型
            dataType: "json", // 数据类型
            success: function(data) { // 请求成功后的回调函数
                let res = []; // 自定义一个空数组接收请求回来的json数据
                
                // 遍历json数据
                for(let i = 0; i < data.length; i++){
                    res.push({
                        name: data[i].name, // 省份名称
                        value: data[i].value, // 坐标
                        sales: data[i].Sales // 销量
                    });
                };

                // 将封装的json数据传递到dealWithData函数中进行渲染处理使用
                dealWithData(res);

            }
        });
    });

    // 渲染ECharts图表
    function dealWithData(data) {
        let dataValue = data;
        option = {
            title: { // 设置一个标题
                text: '中国矿业大学·E心向党社会实践',
                x: 'center',
                textStyle: {
                    color: '#fff',
                    fontSize: "50"
                }
            },
            tooltip: { // 鼠标划过省份下弹框
                show: true,
                triggerOn: 'click' // 点击生效
            },
            geo: {
                map: 'china', // 必须写
                roam: false, // 拖拽功能；自选关闭开启
                zoom: 1.01, // 地图缩放比例
                center: [105, 36], // 地图位置
                itemStyle: { // 地图省份的样式；包括板块颜色和边框颜色
                    areaColor: '#f5f2f2',
                    borderColor: "#835f5f",
                },
                label: { // 省份字体样式；包括是否展示，字体大小和颜色
                    show: true,
                    fontSize: "11.5",
                    color: "rgb(107,102,102)"
                },
                emphasis: { // 鼠标划过的高亮设置；包括省份板块颜色和字体等
                    itemStyle: {
                        areaColor: '#d0a3a3',
                    },
                    label: {
                        show: true,
                        color: "rgb(255,255,255)"
                    }
                }
            },

            series: [
                // 我们的散点
                {
                    name: '销量',
                    type: 'scatter',
                    coordinateSystem: 'geo', // 坐标系统
                    data: dataValue, // 数据
                    symbolSize: 12, // 点的大小
                    itemStyle: {
                        color: "#f13434",
                        shadowBlur: 2,
                        shadowColor: "#333"
                    },
                    tooltip: { // 鼠标点击散点的下弹框
                        show: true,
                        triggerOn: "click",
                        formatter: function(data1) {
                            let data2 = data1.data;
                            return  data2.sales;
                        }
                    },
                },

                // 涟漪特效
                {
                    name: "产品销量",
                    type: "effectScatter",
                    coordinateSystem: "geo",
                    data: dataValue, // 数据
                    symbolSize: 6, // 涟漪大小
                    showEffectOn: "render", // 涟漪效应
                    rippleEffect: {
                        brushType: "stroke",
                        color: "#f13434",
                        period: 10, // 周期
                        scale: 10 // 规模
                    },
                    emphasis: {
                        scale: true, // 悬停动画
                    },
                    label: {
                        formatter: "{b}",
                        position: "top",
                        show: true,
                        fontSize: "10",
                    },
                    itemStyle: {
                        color: "#f13434",
                        shadowBlur: 2,
                        shadowColor: "#333"
                    },
                    tooltip: { // 鼠标点击散点的下弹框
                        show: true,
                        triggerOn: "click",
                        formatter: function(data1) {
                            console.log(data1);
                            let data2 = data1.data;
                            return  data2.sales;
                        }
                    },
                    zlevel: 1
                }
            ]
        };
        myChart.setOption(option); // 应用设置
    }

    // 点击事件处理
    myChart.on('dblclick', function(param) {
        let data = param.data;
        if (data) {
            let url;
        switch (data.name) {
            case '内蒙古':
                url = 'https://www.cumt.edu.cn/';
                break;
            case '重庆':
                url = 'https://www.cumt.edu.cn/kdzc/list.htm';
                break;
            case '沈阳918历史博物馆':
                url = 'https://example.com/918';
                break;
            case '西安事变纪念馆':
                url = 'https://example.com/xian';
                break;
            case '南昌八一起义纪念馆':
                url = 'https://example.com/nanchang';
                break;
            case '商丘陈官庄':
                url = 'https://example.com/chenguangzhuang';
                break;
            case '浙江省台州市茅畲乡下街村，温岭市坞根镇':
                url = 'https://example.com/taizhou';
                break;
            default:
                url = 'https://example.com/default';
        }

        // 跳转到相应的网页
        window.location.href = url;
        }
    });

</script>
</html>
